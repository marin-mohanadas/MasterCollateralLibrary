<div ng-controller="quoteEditController as ctrl" ">
    <p>Pack Processing</p>

    <!-- edit -->
    <div class="panel panel-default" ng-show="quote.id > 0">
        <div class="panel-heading">
            <span style="color:red;" ng-if="quote.qthdr_template"><b>TEMPLATE</b> </span>Quote No. {{quote.qthdr_qn_basis}}-{{quote.qthdr_rev}} - {{quote.tbl_acct.acct_name}}
        </div>
        <div class="panel-body">
            <span ng-style="temp_count!=0 && {'color':'Red'}">
                {{temp_count !== 0 ? "Pack item has not been approved or rejected" : ""}}
            </span>
            <div class="row">
                <div class="col-md-7">
                    <div class="input-group">
                        <span class="input-group-addon" id="basic-addon1">Pack Name</span>
                        <input type="text" class="form-control" ng-model="quote.qthdr_name" />
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="input-group">
                        <span class="input-group-addon" id="basic-addon1">Tray</span>
                        <input type="text" class="form-control" ng-model="quote.qthdr_tray_no" ng-disabled="!profile.CanEditTrayNo" />
                    </div>
                </div>
                <div class="col-md-2">
                    <div class="input-group">
                        <span class="input-group-addon" id="basic-addon1">Rev</span>
                        <input type="text" class="form-control" ng-model="quote.qthdr_rev" readonly />
                        <span class="input-group-btn">
                            <button class="btn btn-default" type="button" ng-click="btnNewRevClicked()">New</button>
                        </span>
                    </div>
                </div>
            </div>
            <br />
            <div class="row">
                <div class="col-md-9">
                    <uib-tabset active="active">
                        <uib-tab index="0" heading="Pack">
                            <br />
                            <uib-progressbar class="progress-striped active" value="100" ng-show="busy">Please wait...</uib-progressbar>
                            <div style="overflow:auto;max-height:640px" ng-hide="busy">

                                <table class="table table-condensed table-striped table-hover">
                                    <thead>
                                        <tr>
                                            <th>
                                                @*<button type="button" ng-click="ctrl.expandAll(allExpanded = !allExpanded)">
                                                        <span ng-bind="allExpanded ? '-' : '+'"></span>
                                                    </button>*@
                                            </th>
                                            <th class="grid-col grid-col-fixed-left" style="cursor: pointer" ng-click="orderByField='tbl_comp.id_display'; reverseSort = !reverseSort"><span ng-class="orderByField!='tbl_comp.id_display' ? '' : orderByField=='tbl_comp.id_display' && reverseSort?'glyphicon glyphicon-arrow-down':'glyphicon glyphicon-arrow-up'"></span>Component ID</th>
                                            <th ng-click="orderByField='tbl_comp.tbl_vend.vendor_display'; reverseSort = !reverseSort"><span ng-class="orderByField!='tbl_comp.tbl_vend.vendor_display' ? '' : orderByField=='tbl_comp.tbl_vend.vendor_display' && reverseSort?'glyphicon glyphicon-arrow-down':'glyphicon glyphicon-arrow-up'"></span>Mfg</th>
                                            <th ng-click="orderByField='qtdtl_comp_qty'; reverseSort = !reverseSort"><span ng-class="orderByField!='qtdtl_comp_qty' ? '' : orderByField=='qtdtl_comp_qty' && reverseSort?'glyphicon glyphicon-arrow-down':'glyphicon glyphicon-arrow-up'"></span>Qty</th>
                                            <th ng-click="orderByField='tbl_comp.comp_vend_pn'; reverseSort = !reverseSort"><span ng-class="orderByField!='tbl_comp.comp_vend_pn' ? '' : orderByField=='tbl_comp.comp_vend_pn' && reverseSort?'glyphicon glyphicon-arrow-down':'glyphicon glyphicon-arrow-up'"></span>Part # <button class="btn btn-default btn-xs" ng-click="requestNewPartBtnClicked()" ng-disabled="quote.qthdr_status_id == 6">request new</button>
                                            <th ng-click="orderByField='tbl_comp.comp_desc_orig'; reverseSort = !reverseSort"><span ng-class="orderByField!='tbl_comp.comp_desc_orig' ? '' : orderByField=='tbl_comp.comp_desc_orig' && reverseSort?'glyphicon glyphicon-arrow-down':'glyphicon glyphicon-arrow-up'"></span>Description <button class="btn btn-xs btn-primary" ng-click="addLineBtnClicked()" ng-disabled="quote.qthdr_status_id == 6">add</button></th>
                                            <!--Trinity - Added columns for acl, latex, sterility and monthly usage-->
                                            <th ng-click="orderByField='tbl_comp.comp_acl'; reverseSort = !reverseSort"><span ng-class="orderByField!='tbl_comp.comp_acl' ? '' : orderByField=='tbl_comp.comp_acl' && reverseSort?'glyphicon glyphicon-arrow-down':'glyphicon glyphicon-arrow-up'"></span>ACL</th>
                                            <th ng-click="orderByField='tbl_comp.comp_latex'; reverseSort = !reverseSort"><span ng-class="orderByField!='tbl_comp.comp_latex' ? '' : orderByField=='tbl_comp.comp_latex' && reverseSort?'glyphicon glyphicon-arrow-down':'glyphicon glyphicon-arrow-up'"></span>Latex</th>
                                            <th ng-click="orderByField='tbl_comp.comp_strlty'; reverseSort = !reverseSort"><span ng-class="orderByField!='tbl_comp.comp_strlty' ? '' : orderByField=='tbl_comp.comp_strlty' && reverseSort?'glyphicon glyphicon-arrow-down':'glyphicon glyphicon-arrow-up'"></span>Sterile</th>
                                            <th ng-click="orderByField='tbl_comp.comp_use_vendor_contract'; reverseSort = !reverseSort"><span ng-class="orderByField!='tbl_comp.comp_use_vendor_contract' ? '' : orderByField=='tbl_comp.comp_use_vendor_contract' && reverseSort?'glyphicon glyphicon-arrow-down':'glyphicon glyphicon-arrow-up'"></span>Contract</th>
                                            <th ng-click="orderByField='quote.qthdr_amu'; reverseSort = !reverseSort"><span ng-class="orderByField!='quote.qthdr_amu' ? '' : orderByField=='quote.qthdr_amu' && reverseSort?'glyphicon glyphicon-arrow-down':'glyphicon glyphicon-arrow-up'"></span>Monthly Usage</th>
                                            <th ng-click="orderByField='qtdtl_comp_case'; reverseSort = !reverseSort"><span ng-class="orderByField!='qtdtl_comp_case' ? '' : orderByField=='qtdtl_comp_case' && reverseSort?'glyphicon glyphicon-arrow-down':'glyphicon glyphicon-arrow-up'"></span>Level</th>
                                            <th ng-click="orderByField='uom'; reverseSort = !reverseSort"><span ng-class="orderByField!='uom' ? '' : orderByField=='uom' && reverseSort?'glyphicon glyphicon-arrow-down':'glyphicon glyphicon-arrow-up'"></span>UM</th>
                                            <th ng-click="orderByField='cost'; reverseSort = !reverseSort"><span ng-class="orderByField!='cost' ? '' : orderByField=='cost' && reverseSort?'glyphicon glyphicon-arrow-down':'glyphicon glyphicon-arrow-up'"></span>Cost</th>
                                            <th ng-click="orderByField='extCost'; reverseSort = !reverseSort"><span ng-class="orderByField!='extCost' ? '' : orderByField=='extCost' && reverseSort?'glyphicon glyphicon-arrow-down':'glyphicon glyphicon-arrow-up'"></span>Ext Cost</th>

                                            <th></th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr ng-repeat-start="item in quote.tbl_qtdtl | orderBy:orderByField:reverseSort" ng-if="!item.qtdtl_parent_id || item.qtdtl_parent_id < 1">
                                            <td>
                                                <button ng-click="item.expanded = !item.expanded" expand ng-show="item.qtdtl_assembly_name">
                                                    <span ng-bind="item.expanded ? '-' : '+'"></span>
                                                </button>
                                            </td>
                                            <td class="grid-item-locked-noborder" ng-style="item.tbl_comp.comp_temp_item && {'background-color':'LightPink'} || item.PurchInfoComplete !== true && {'background-color':'LightYellow'}">
                                                <a id="MCLeditLink" target="_blank" href="/ComponentList/Edit/{{item.tbl_comp.id}}?quoteID={{quote.id}}&quoteQN={{quote.qthdr_qn_basis}}-{{quote.qthdr_rev}}">
                                                    {{item.tbl_comp.id_display}}
                                                </a>
                                                <a href="#" ng-if="!item.PurchInfoComplete" ng-click="messageModalPopup('Missing Fields', item.CompErrors)"><img src="~/Content/images/caution_refer_to_instruction.png" height="20" width="18" /></a>
                                            </td>
                                            <td>
                                                <span>{{item.tbl_comp.tbl_vend.vendor_display}}</span>
                                                @*<span ng-if="!item.tbl_comp.tbl_vend.vend_label_name">{{item.tbl_comp.tbl_vend.vend_child_name}}</span>*@
                                            </td>
                                            <td style="width:50px">
                                                <span ng-if="item.id !== selectedLine.id">{{item.qtdtl_comp_qty}}</span>
                                                <input style="width:50px" type="number" ng-show="selectedLine.id === item.id" ng-model="selectedLine.qtdtl_comp_qty" />
                                            </td>
                                            <td>
                                                <i class="glyphicon glyphicon-plus" style="cursor:pointer" ng-show="item.qtdtl_assembly_name" ng-click="showAssemblyBtnClicked(item)"></i>
                                                <span ng-if="item.qtdtl_assembly_name">{{item.qtdtl_assembly_name}}</span>
                                                <span ng-if="(item.tbl_comp.tbl_X_ref.length === 0 || !item.tbl_comp.tbl_X_ref) && !item.qtdtl_assembly_name">{{item.tbl_comp.comp_vend_pn}}</span>
                                                <a style="cursor:pointer" ng-show="item.tbl_comp.tbl_X_ref.length > 0" ng-click="lineSwitchItemBtnClicked(item)"><span class="label label-warning">{{item.tbl_comp.comp_vend_pn}}</span></a>
                                            </td>
                                            <td>
                                                <span ng-if="!item.qtdtl_assembly_name">{{item.tbl_comp.comp_desc_orig}}</span>
                                            </td>
                                            <!--Trinity - Added columns for acl, latex, sterility and monthly usage-->
                                            <td>
                                                <input type="checkbox" ng-hide="selectedLine.id == item.id" ng-model="item.tbl_comp.comp_acl" ng-disabled="true">
                                                <input type="checkbox" ng-show="selectedLine.id === item.id" ng-model="selectedLine.tbl_comp.comp_acl" ng-disabled="true">
                                            </td>
                                            <td>
                                                <input type="checkbox" ng-hide="selectedLine.id == item.id" ng-model="item.tbl_comp.comp_latex" ng-disabled="true">
                                                <input type="checkbox" ng-show="selectedLine.id === item.id" ng-model="selectedLine.tbl_comp.comp_latex" ng-disabled="true">
                                            </td>
                                            <td>
                                                <input type="checkbox" ng-hide="selectedLine.id == item.id" ng-model="item.tbl_comp.strlty_cb" ng-disabled="true">
                                                <input type="checkbox" ng-show="selectedLine.id === item.id" ng-model="selectedLine.tbl_comp.strlty_cb" ng-disabled="true">
                                            </td>
                                            <td>
                                                <input type="checkbox" ng-hide="selectedLine.id == item.id" ng-model="item.tbl_comp.comp_use_vendor_contract" ng-disabled="true">
                                                <input type="checkbox" ng-show="selectedLine.id === item.id" ng-model="selectedLine.tbl_comp.comp_use_vendor_contract" ng-disabled="true">
                                            </td>
                                            <td>
                                                <span>{{item.MonthlyAMU}}</span>
                                            </td>
                                            <td style="width:100px">
                                                <span ng-if="item.id !== selectedLine.id">{{item.qtdtl_comp_case}}</span>
                                                <select type="text" style="width:60px"
                                                        ng-show="selectedLine.id === item.id"
                                                        ng-model="selectedLine.qtdtl_comp_case"
                                                        ng-options="option for option in complevels track by option"></select>
                                            </td>
                                            <td>
                                                <span ng-if="item.cost">{{item.uom}}</span>
                                            </td>
                                            <td>
                                                <span ng-if="item.cost">{{item.cost | number:2}}</span>
                                            </td>
                                            <td>
                                                <span ng-if="item.extCost">{{item.extCost | number:2}}</span>
                                            </td>
                                            <td style="width:70px">
                                                <button class="btn btn-default btn-xs" ng-hide="selectedLine.id === item.id" ng-disabled="quote.qthdr_status_id == 6">
                                                    <i class="glyphicon glyphicon-pencil" ng-click="lineEditBtnEditClicked(item)"></i>
                                                </button>
                                                <button class="btn btn-default btn-xs" ng-if="item.id === selectedLine.id">
                                                    <i class="glyphicon glyphicon-ok" ng-click="lineEditBtnOkClicked(item)"></i>
                                                </button>
                                                <button class="btn btn-default btn-xs" ng-if="item.id === selectedLine.id">
                                                    <i class="glyphicon glyphicon-remove" ng-click="lineEditBtnCancelClicked(item)"></i>
                                                </button>
                                                <button class="btn btn-default btn-xs" ng-hide="item.id === selectedLine.id" ng-disabled="quote.qthdr_status_id == 6">
                                                    <i class="glyphicon glyphicon-trash" ng-click="lineDeleteBtnClicked(item)"></i>
                                                </button>
                                            </td>
                                        </tr>
                                        <tr ng-repeat-end ng-show="item.expanded" ng-repeat="sub in quote.tbl_qtdtl" ng-if="sub.qtdtl_parent_id && sub.qtdtl_parent_id === item.id">
                                            <td>|_</td>
                                            <td ng-style="sub.tbl_comp.comp_temp_item && {'background-color':'LightPink'} || sub.PurchInfoComplete !== true && {'background-color':'LightYellow'}">
                                                <a id="MCLeditLink" target="_blank" href="/ComponentList/Edit/{{sub.tbl_comp.id}}">
                                                    {{sub.tbl_comp.id_display}}
                                                </a>
                                                <a href="#" ng-if="!sub.PurchInfoComplete" ng-click="messageModalPopup('Missing Fields', sub.CompErrors)"><img src="~/Content/images/caution_refer_to_instruction.png" height="20" width="18" /></a>
                                            </td>
                                            <td>
                                                <span>{{sub.tbl_comp.tbl_vend.vendor_display}}</span>
                                                @*<span ng-if="!sub.tbl_comp.tbl_vend.vend_label_name">{{sub.tbl_comp.tbl_vend.vend_child_name}}</span>*@
                                            </td>
                                            <td style="width: 50px">
                                                <span ng-if="sub.id !== selectedLine.id">{{sub.qtdtl_comp_qty}}</span>
                                                <input style="width: 50px" type="number" ng-show="selectedLine.id === sub.id" ng-model="selectedLine.qtdtl_comp_qty" />
                                            </td>
                                            <td>
                                                <i class="glyphicon glyphicon-plus" style="cursor: pointer" ng-show="sub.qtdtl_assembly_name" ng-click="showAssemblyBtnClicked(item)"></i>
                                                <span ng-if="sub.qtdtl_assembly_name">{{sub.qtdtl_assembly_name}}</span>
                                                <span ng-if="(sub.tbl_comp.tbl_X_ref.length === 0 || !sub.tbl_comp.tbl_X_ref) && !sub.qtdtl_assembly_name">{{sub.tbl_comp.comp_vend_pn}}</span>
                                                <a style="cursor: pointer" ng-show="sub.tbl_comp.tbl_X_ref.length > 0" ng-click="lineSwitchItemBtnClicked(item)"><span class="label label-warning">{{sub.tbl_comp.comp_vend_pn}}</span></a>
                                            </td>
                                            <td>
                                                <span ng-if="!sub.qtdtl_assembly_name">{{sub.tbl_comp.comp_desc_orig}}</span>
                                            </td>
                                            <!--Trinity - Added columns for acl, latex, sterility and monthly usage-->
                                            <td>
                                                <input type="checkbox" ng-hide="selectedLine.id == sub.id" ng-model="sub.tbl_comp.comp_acl" ng-disabled="true">
                                                <input type="checkbox" ng-show="selectedLine.id === sub.id" ng-model="selectedLine.tbl_comp.comp_acl" ng-disabled="true">
                                            </td>
                                            <td>
                                                <input type="checkbox" ng-hide="selectedLine.id == sub.id" ng-model="sub.tbl_comp.comp_latex" ng-disabled="true">
                                                <input type="checkbox" ng-show="selectedLine.id === sub.id" ng-model="selectedLine.tbl_comp.comp_latex" ng-disabled="true">
                                            </td>
                                            <td>
                                                <input type="checkbox" ng-hide="selectedLine.id == sub.id" ng-model="sub.tbl_comp.strlty_cb" ng-disabled="true">
                                                <input type="checkbox" ng-show="selectedLine.id === sub.id" ng-model="selectedLine.tbl_comp.strlty_cb" ng-disabled="true">
                                            </td>
                                            <td>
                                                <span>{{sub.MonthlyAMU}}</span>
                                            </td>
                                            <td style="width: 100px">
                                                <span ng-if="sub.id !== selectedLine.id">{{sub.qtdtl_comp_case}}</span>
                                                <select type="text" style="width: 60px"
                                                        ng-show="selectedLine.id === sub.id"
                                                        ng-model="selectedLine.qtdtl_comp_case"
                                                        ng-options="option for option in complevels track by option"></select>
                                            </td>
                                            <td>
                                                <span ng-if="sub.cost">{{sub.uom}}</span>
                                            </td>
                                            <td>
                                                <span ng-if="sub.cost">{{sub.cost | number:2}}</span>
                                            </td>
                                            <td>
                                                <span ng-if="sub.extCost">{{sub.extCost | number:2}}</span>
                                            </td>
                                            <td style="width:70px">
                                                <button class="btn btn-default btn-xs" ng-hide="selectedLine.id === sub.id" ng-disabled="quote.qthdr_status_id == 6">
                                                    <i class="glyphicon glyphicon-pencil" ng-click="lineEditBtnEditClicked(sub)"></i>
                                                </button>
                                                <button class="btn btn-default btn-xs" ng-if="sub.id === selectedLine.id">
                                                    <i class="glyphicon glyphicon-ok" ng-click="lineEditBtnOkClicked(sub)"></i>
                                                </button>
                                                <button class="btn btn-default btn-xs" ng-if="sub.id === selectedLine.id">
                                                    <i class="glyphicon glyphicon-remove" ng-click="lineEditBtnCancelClicked(sub)"></i>
                                                </button>
                                                @*<button class="btn btn-default btn-xs" ng-hide="item.id === selectedLine.id" ng-disabled="quote.qthdr_status_id == 6">
                                                        <i class="glyphicon glyphicon-trash" ng-click="lineDeleteBtnClicked(item)"></i>
                                                    </button>*@
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <div class="row" ng-if="quotePrice">
                                <div class="col-md-6">
                                    <table class="table table-condensed">
                                        <tr>
                                            <th>Material</th>
                                            <th>EACH</th>
                                            <th>CASE</th>
                                        </tr>
                                        <tr>
                                            <td>Material Cost</td>
                                            <td>{{initalSellCurrency.currncy_symb}}{{quotePrice.MaterialCost | number:3}}</td>
                                            <td>{{initalSellCurrency.currncy_symb}}{{quotePrice.MaterialCostCS | number:3}}</td>
                                        </tr>
                                        <tr>
                                            <td>Component Shipping Cost</td>
                                            <td>{{initalSellCurrency.currncy_symb}}{{quotePrice.ComponentShippingCost | number:3}}</td>
                                            <td>{{initalSellCurrency.currncy_symb}}{{quotePrice.ComponentShippingCostCS | number:3}}</td>
                                        </tr>
                                        <tr>
                                            <td>Total Material Cost</td>
                                            <td>{{initalSellCurrency.currncy_symb}}{{quotePrice.TotalMaterialCost | number:3}}</td>
                                            <td>{{initalSellCurrency.currncy_symb}}{{quotePrice.TotalMaterialCostCS | number:3}}</td>
                                        </tr>
                                        <tr>
                                            <th>Labor</th>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td>Component Count</td>
                                            <td>{{quotePrice.ComponentCount | number:0}}</td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td>Labor Time (Seconds)</td>
                                            <td>{{quotePrice.LaborTimeInSeconds | number:2}}</td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td>Labor Rate</td>
                                            <td>{{quotePrice.LaborRate | number:4}}</td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td>Labor Factor</td>
                                            <td>{{quotePrice.LaborFactor | number:2}}</td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td>Labor Cost</td>
                                            <td>{{quotePrice.LaborCost | number:2}}</td>
                                            <td>{{quotePrice.LaborCostCS | number:2}}</td>
                                        </tr>
                                        <tr>
                                            <th>Sterilization</th>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td>Sterilization Cost</td>
                                            <td>{{initalSellCurrency.currncy_symb}}{{quotePrice.SterilizationCost | number:3}}</td>
                                            <td>{{initalSellCurrency.currncy_symb}}{{quotePrice.SterilizationCostCS | number:3}}</td>
                                        </tr>
                                        <tr>
                                            <th>Subtotal (Materials, Labor &amp; Sterilization)</th>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td>Direct Cost</td>
                                            <td>{{initalSellCurrency.currncy_symb}}{{quotePrice.DirectCost | number:3}}</td>
                                            <td>{{initalSellCurrency.currncy_symb}}{{quotePrice.DirectCostCS | number:3}}</td>
                                        </tr>

                                    </table>
                                </div>
                                <div class="col-md-6">
                                    <table class="table table-condensed">
                                        <tr>
                                            <th>General (Indirect)</th>
                                            <th>EACH</th>
                                            <th>CASE</th>
                                        </tr>
                                        <tr>
                                            <td>Overhead</td>
                                            <td>{{initalSellCurrency.currncy_symb}}{{quotePrice.OverheadCost | number:3}}</td>
                                            <td>{{initalSellCurrency.currncy_symb}}{{quotePrice.OverheadCostCS | number:3}}</td>
                                        </tr>
                                        <tr>
                                            <td>Inland Freight</td>
                                            <td>{{initalSellCurrency.currncy_symb}}{{quotePrice.InlandFreightCost | number:3}}</td>
                                            <td>{{initalSellCurrency.currncy_symb}}{{quotePrice.InlandFreightCostCS | number:3}}</td>
                                        </tr>
                                        <tr>
                                            <td>G&amp;A</td>
                                            <td>{{initalSellCurrency.currncy_symb}}{{quotePrice.GACost | number:3}}</td>
                                            <td>{{initalSellCurrency.currncy_symb}}{{quotePrice.GACostCS | number:3}}</td>
                                        </tr>
                                        <tr>
                                            <td>Finance Cost</td>
                                            <td>{{initalSellCurrency.currncy_symb}}{{quotePrice.FinanceCost | number:3}}</td>
                                            <td>{{initalSellCurrency.currncy_symb}}{{quotePrice.FinanceCostCS | number:3}}</td>
                                        </tr>
                                        <tr>
                                            <td>Warehouse Cost</td>
                                            <td>{{initalSellCurrency.currncy_symb}}{{quotePrice.WarehouseCost | number:3}}</td>
                                            <td>{{initalSellCurrency.currncy_symb}}{{quotePrice.WarehouseCostCS | number:3}}</td>
                                        </tr>
                                        <tr>
                                            <th>Standard Cost</th>
                                            <td>{{initalSellCurrency.currncy_symb}}{{quotePrice.StandardCost | number:3}}</td>
                                            <td>{{initalSellCurrency.currncy_symb}}{{quotePrice.StandardCostCS | number:3}}</td>
                                        </tr>
                                        <tr>
                                            <th>Pre-Import Selling Price</th>
                                            <td>{{initalSellCurrency.currncy_symb}}{{quotePrice.PreImportSellingPrice | number:3}}</td>
                                            <td>{{initalSellCurrency.currncy_symb}}{{quotePrice.PreImportSellingPriceCS | number:3}}</td>
                                        </tr>
                                        <tr>
                                            <th>Import Cost</th>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td>Ocean freight</td>
                                            <td>{{initalSellCurrency.currncy_symb}}{{quotePrice.OceanFreightCost | number:3}}</td>
                                            <td>{{initalSellCurrency.currncy_symb}}{{quotePrice.OceanFreightCostCS | number:3}}</td>
                                        </tr>
                                        <tr>
                                            <td>Import Duty</td>
                                            <td>{{initalSellCurrency.currncy_symb}}{{quotePrice.ImportDuty | number:3}}</td>
                                            <td>{{initalSellCurrency.currncy_symb}}{{quotePrice.ImportDutyCS | number:3}}</td>
                                        </tr>
                                        <tr>
                                            <td>Excise Tax</td>
                                            <td>{{initalSellCurrency.currncy_symb}}{{quotePrice.ExciseTax | number:3}}</td>
                                            <td>{{initalSellCurrency.currncy_symb}}{{quotePrice.ExciseTaxCS | number:3}}</td>
                                        </tr>
                                        <tr>
                                            <td>Total Import Costs</td>
                                            <td>{{initalSellCurrency.currncy_symb}}{{quotePrice.TotalImportCost | number:3}}</td>
                                            <td>{{initalSellCurrency.currncy_symb}}{{quotePrice.TotalImportCostCS | number:3}}</td>
                                        </tr>
                                        <tr>
                                            <th>Manufacturing Cost</th>
                                            <th>{{initalSellCurrency.currncy_symb}}{{quotePrice.FinalMfgCost | number:3}}</th>
                                            <th>{{initalSellCurrency.currncy_symb}}{{quotePrice.FinalMfgCostCS | number:3}}</th>
                                        </tr>
                                        @*  *@
                                        <tr ng-show="quote.tbl_acct.acct_admin > 0">
                                            <td>Admin Fees ({{quote.tbl_acct.acct_admin * 100 | number:3}}%)</td>
                                            <td>{{initalSellCurrency.currncy_symb}}{{quote.tbl_acct.acct_admin * quotePrice.FinalMfgCost | number:3}}</td>
                                            <td>{{initalSellCurrency.currncy_symb}}{{quote.tbl_acct.acct_admin * quotePrice.FinalMfgCostCS | number:3}}</td>
                                        </tr>
                                        <tr ng-show="quote.tbl_acct.acct_whrhs > 0">
                                            <td>Warehouse Fees ({{quote.tbl_acct.acct_whrhs * 100 | number:3}}%)</td>
                                            <td>{{initalSellCurrency.currncy_symb}}{{quote.tbl_acct.acct_whrhs * quotePrice.FinalMfgCost | number:3}}</td>
                                            <td>{{initalSellCurrency.currncy_symb}}{{quote.tbl_acct.acct_whrhs * quotePrice.FinalMfgCostCS | number:3}}</td>
                                        </tr>
                                        <tr ng-show="quote.tbl_acct.acct_frght > 0">
                                            <td>Freight Fees ({{quote.tbl_acct.acct_frght * 100 | number:3}}%)</td>
                                            <td>{{initalSellCurrency.currncy_symb}}{{quote.tbl_acct.acct_frght * quotePrice.FinalMfgCost | number:3}}</td>
                                            <td>{{initalSellCurrency.currncy_symb}}{{quote.tbl_acct.acct_frght * quotePrice.FinalMfgCostCS | number:3}}</td>
                                        </tr>
                                        <tr ng-show="quote.tbl_acct.acct_misc > 0">
                                            <td>Misc Fees ({{quote.tbl_acct.acct_misc * 100 | number:3}}%)</td>
                                            <td>{{initalSellCurrency.currncy_symb}}{{quote.tbl_acct.acct_misc * quotePrice.FinalMfgCost | number:3}}</td>
                                            <td>{{initalSellCurrency.currncy_symb}}{{quote.tbl_acct.acct_misc * quotePrice.FinalMfgCostCS | number:3}}</td>
                                        </tr>
                                        <tr ng-show="quote.tbl_acct.acct_logstcs > 0">
                                            <td>Logistics Fees ({{quote.tbl_acct.acct_logstcs * 100 | number:3}}%)</td>
                                            <td>{{initalSellCurrency.currncy_symb}}{{quote.tbl_acct.acct_logstcs * quotePrice.FinalMfgCost | number:3}}</td>
                                            <td>{{initalSellCurrency.currncy_symb}}{{quote.tbl_acct.acct_logstcs * quotePrice.FinalMfgCostCS | number:3}}</td>
                                        </tr>
                                        <tr ng-show="quote.tbl_acct.acct_spif_percent_fee > 0">
                                            <td>SPIF Fees ({{quote.tbl_acct.acct_spif_percent_fee * 100 | number:3}}%)</td>
                                            <td>{{initalSellCurrency.currncy_symb}}{{quote.tbl_acct.acct_spif_percent_fee * quotePrice.FinalMfgCost | number:3}}</td>
                                            <td>{{initalSellCurrency.currncy_symb}}{{quote.tbl_acct.acct_spif_percent_fee * quotePrice.FinalMfgCostCS | number:3}}</td>
                                        </tr>
                                        <tr ng-show="quote.tbl_acct.acct_gpo_percent_fee > 0">
                                            <td>GPO Fees ({{quote.tbl_acct.acct_gpo_percent_fee * 100 | number:3}}%)</td>
                                            <td>{{initalSellCurrency.currncy_symb}}{{quote.tbl_acct.acct_gpo_percent_fee * quotePrice.FinalMfgCost | number:3}}</td>
                                            <td>{{initalSellCurrency.currncy_symb}}{{quote.tbl_acct.acct_gpo_percent_fee * quotePrice.FinalMfgCostCS | number:3}}</td>
                                        </tr>
                                        <tr ng-show="quote.tbl_acct.acct_marketing_percent_fee > 0">
                                            <td>Marketing Fees ({{quote.tbl_acct.acct_marketing_percent_fee * 100 | number:3}}%)</td>
                                            <td>{{initalSellCurrency.currncy_symb}}{{quote.tbl_acct.acct_marketing_percent_fee * quotePrice.FinalMfgCost | number:3}}</td>
                                            <td>{{initalSellCurrency.currncy_symb}}{{quote.tbl_acct.acct_marketing_percent_fee * quotePrice.FinalMfgCostCS | number:3}}</td>
                                        </tr>
                                        @*  *@
                                        <tr>
                                            <th>Final Manufacturing Cost With Fees</th>
                                            <th>{{initalSellCurrency.currncy_symb}}{{quotePrice.FinalMfgCostAndFees | number:3}}</th>
                                            <th>{{initalSellCurrency.currncy_symb}}{{quotePrice.FinalMfgCostAndFeesCS | number:3}}</th>
                                        </tr>
                                        <tr ng-show="quotePrice.Rebates > 0">
                                            <td>Rebates</td>
                                            <td>{{initalSellCurrency.currncy_symb}}{{quotePrice.Rebates | number:3}}</td>
                                            <td>{{initalSellCurrency.currncy_symb}}{{quotePrice.RebatesCS | number:3}}</td>
                                        </tr>
                                        <tr ng-show="quotePrice.Rebates > 0">
                                            <th>Final Rebated Manufacturing Cost With Fees</th>
                                            <th>{{initalSellCurrency.currncy_symb}}{{quotePrice.FinalMfgCostAndFees - quotePrice.Rebates | number:3}}</th>
                                            <th>{{initalSellCurrency.currncy_symb}}{{quotePrice.FinalMfgCostAndFeesCS - quotePrice.RebatesCS | number:3}}</th>
                                        </tr>
                                        <tr>
                                            <th>Final Price</th>
                                            <th>{{initalSellCurrency.currncy_symb}}{{quotePrice.FinalPrice | number:3}}</th>
                                            <th>{{initalSellCurrency.currncy_symb}}{{quotePrice.FinalPriceCS | number:3}}</th>
                                        </tr>
                                    </table>
                                </div>
                            </div>
                        </uib-tab>
                        <uib-tab index="1" heading="Map"></uib-tab>
                        <uib-tab index="2" heading="History" ng-click="loadQuoteHistory()">
                            <table class="table table-striped table-hover">
                                <thead>
                                    <tr>
                                        <th ng-click="orderByField='Date_Recorded'; reverseSort = !reverseSort">Date Recorded<span ng-class="orderByField!='Date_Recorded' ? '' : orderByField=='Date_Recorded' && reverseSort?'glyphicon glyphicon-arrow-down':'glyphicon glyphicon-arrow-up'"></th>
                                        <th ng-click="orderByField='QuoteNoAndRev'; reverseSort = !reverseSort">
                                            Quote No<span ng-class="orderByField!='QuoteNoAndRev' ? '' : orderByField=='QuoteNoAndRev' && reverseSort?'glyphicon glyphicon-arrow-down':'glyphicon glyphicon-arrow-up'">
                                                <input type="search" ng-style="{ 'color' : 'black' }" ng-model="search.$" size="5">
                                        </th>
                                        <th ng-click="orderByField='ComponentCount'; reverseSort = !reverseSort">Component Count<span ng-class="orderByField!='ComponentCount' ? '' : orderByField=='ComponentCount' && reverseSort?'glyphicon glyphicon-arrow-down':'glyphicon glyphicon-arrow-up'"></th>
                                        <th ng-click="orderByField='StandardCost'; reverseSort = !reverseSort">Standard Cost<span ng-class="orderByField!='StandardCost' ? '' : orderByField=='StandardCost' && reverseSort?'glyphicon glyphicon-arrow-down':'glyphicon glyphicon-arrow-up'"></th>
                                        <th ng-click="orderByField='FinalMfgCost'; reverseSort = !reverseSort">Mfg Cost<span ng-class="orderByField!='FinalMfgCost' ? '' : orderByField=='FinalMfgCost' && reverseSort?'glyphicon glyphicon-arrow-down':'glyphicon glyphicon-arrow-up'"></th>
                                        <th ng-click="orderByField='Fees'; reverseSort = !reverseSort">Fees<span ng-class="orderByField!='Fees' ? '' : orderByField=='Fees' && reverseSort?'glyphicon glyphicon-arrow-down':'glyphicon glyphicon-arrow-up'"></th>
                                        <th ng-click="orderByField='FinalMfgCostAndFees'; reverseSort = !reverseSort">Mfg Cost And Fees<span ng-class="orderByField!='FinalMfgCostAndFees' ? '' : orderByField=='FinalMfgCostAndFees' && reverseSort?'glyphicon glyphicon-arrow-down':'glyphicon glyphicon-arrow-up'"></th>
                                        <th ng-click="orderByField='FinalPrice'; reverseSort = !reverseSort">Final Price<span ng-class="orderByField!='FinalPrice' ? '' : orderByField=='FinalPrice' && reverseSort?'glyphicon glyphicon-arrow-down':'glyphicon glyphicon-arrow-up'"></th>
                                        <th ng-click="orderByField='Margin'; reverseSort = !reverseSort">Margin<span ng-class="orderByField!='Margin' ? '' : orderByField=='Margin' && reverseSort?'glyphicon glyphicon-arrow-down':'glyphicon glyphicon-arrow-up'"></th>
                                        <th ng-click="orderByField='CaseQty'; reverseSort = !reverseSort">Case Qty<span ng-class="orderByField!='CaseQty' ? '' : orderByField=='CaseQty' && reverseSort?'glyphicon glyphicon-arrow-down':'glyphicon glyphicon-arrow-up'"></th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr ng-repeat="quote in quote_history | orderBy:orderByField:reverseSort | filter:search:strict">
                                        <td>{{convertJsonDate(quote.Date_Recorded)}}</td>
                                        <td>{{quote.QuoteNoAndRev}}</td>
                                        <td>{{quote.ComponentCount}}</td>
                                        <td>{{quote.StandardCost}}</td>
                                        <td>{{quote.FinalMfgCost}}</td>
                                        <td>{{quote.Fees}}</td>
                                        <td>{{quote.FinalMfgCostAndFees}}</td>
                                        <td>{{quote.FinalPrice}}</td>
                                        <td>
                                            {{quote.Margin > 1 ? quote.Margin : quote.Margin * 100 | number:2}}%
                                        </td>
                                        <td>{{quote.CaseQty}}</td>
                                    </tr>
                                </tbody>
                            </table>
                            <ul uib-pagination class="pagination-sm" total-items="HistoryParam.total" items-per-page="HistoryParam.PageSize" ng-model="HistoryParam.PageNumber" ng-change="historyPageChanged()"
                                max-size="5" boundary-links="true" previous-text="&lsaquo;" next-text="&rsaquo;" first-text="&laquo;" last-text="&raquo;"></ul>
                        </uib-tab>
                    </uib-tabset>
                </div>
                <div class="col-md-3">
                    <div class="panel panel-default" style="background-color:lightblue">
                        <div class="panel-body">
                            <div class="row">
                                <div class="col-md-12">
                                    <button class="form-control btn btn-default" ng-click="addAssemblyBtnClicked()">Create a new Sub Assembly</button>
                                </div>
                                <br />
                            </div>
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="form-group">
                                        <label for="">Sell Currency</label>
                                        <select type="text" class="form-control" ng-model="selectedSellCurrency"
                                                ng-options="option.currncy_name for option in sellCurrencies track by option.id"></select>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="form-group">
                                        <label for="">Manufacturing Plant</label>
                                        <select type="text" class="form-control" ng-model="selectedPlant" ng-change="selectedPlantChanged()"
                                                ng-options="option.plant_name for option in plants track by option.id"></select>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="form-group">
                                        <label for="">Formula</label>
                                        <select class="form-control" ng-model="selectedFormula"
                                                ng-options="option.formula_name for option in formulas track by option.id"></select>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="form-group" style="text-align:center">
                                        Sterile <input type="checkbox" ng-model="quote.qthdr_sterility" />
                                    </div>
                                </div>
                            </div>
                            <div class="row" ng-if="quote.qthdr_sterility">
                                <div class="col-md-12">
                                    <div class="form-group">
                                        <label for="">Sterilization Method</label>
                                        <select type="text" class="form-control" ng-model="quote.qthdr_sterility_mthd"
                                                ng-options="option for option in sterilizationMethods track by option"></select>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="form-group">
                                        <label for="">Box</label>
                                        <select type="text" class="form-control" ng-model="selectedBox"
                                                ng-options="option.box_desc for option in boxes track by option.id"></select>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="form-group">
                                        <label>Sales Rep</label>
                                        <select type="text" class="form-control" ng-model="selectedRep"
                                                ng-options="option.rep_fname + ' ' + option.rep_lname for option in reps track by option.id"></select>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="form-group">
                                        <label>Brand</label>
                                        <select type="text" class="form-control" ng-model="selectedBrand"
                                                ng-options="option.brand_name for option in brands track by option.id"></select>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="form-group">
                                        @*<label>Annual Usage</label>*@
                                        <label>Monthly Usage (Pack)</label>
                                        <input type="number" class="form-control" ng-model="quote.qthdr_amu" />
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="form-group">
                                        <label>Case Quantity</label>
                                        <input type="number" class="form-control" ng-model="quote.qthdr_cs_qty" />
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="form-group">
                                        <label>{{initalSellCurrency.currncy_symb}} Sell Price (Each)</label>
                                        <input type="number" class="form-control" ng-model="quote.qthdr_sell_price" ng-change="sellpriceChanged()" />
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="form-group">
                                        <label>Margin %</label>
                                        @*<input type="number" class="form-control" ng-model="quote.qthdr_margin" ng-change="marginChanged()" />*@
                                        @*<label>{{quotePrice.Margin * 100 | number:2}}</label>*@
                                        <input type="number" class="form-control" value="{{quotePrice.Margin * 100 | number:4}}" ng-disabled="true" />
                                    </div>
                                </div>
                            </div>
                            <div class="row" ng-if="quote.IsFinishedGood">
                                <div class="col-md-12">
                                    <div class="form-group">
                                        <label>Finished Good Number</label>
                                        <input type="text" class="form-control" ng-model="quote.qthdr_fg_num" readonly />
                                    </div>
                                </div>
                            </div>
                            <div class="row" ng-if="quote.IsFinishedGood && quote.qthdr_status_id == 6">
                                <div class="col-md-12">
                                    <div class="form-group">
                                        <label>{{initalSellCurrency.currncy_symb}} New Award Manufacture Cost </label>
                                        <input type="number" class="form-control" value="{{quote.qthdr_newAwardFinalMfgCost | number:4}}" readonly />
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12">
                                    <label>Status</label>
                                    <div class="panel panel-default">
                                        <div class="panel-body">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    <select type="text" class="form-control" ng-model="selectedQuoteStatus"
                                                            ng-options="option.qtstatus_desc for option in quoteStatuses track by option.id" ng-change="selectedStatusChange()"></select>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-12">
                                                    <input type="checkbox" name="qcApproval" ng-model="quote.qthdr_qcApproval" ng-change="qcApprovalChange()" /> Submit for QC Approval
                                                </div>
                                            </div><br />
                                            <div class="row" ng-if="!quote.IsFinishedGood">
                                                <div class="col-md-12">
                                                    <button class="btn btn-default form-control" ng-click="btnNewAwardClicked()" ng-disabled="!profile.CanAwardQuote">New Award</button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="form-group">
                                        <label>Notes</label>
                                        <textarea class="form-control" ng-model="quote.qthdr_instr"></textarea>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="panel panel-default">
                                        <div class="panel-body">
                                            @*<div class="row">
                                                        <div class="col-md-12">
                                                            <table>
                                                                <tr>
                                                    <td>Submit for QC Approval:</td>
                                                    <td><input type="checkbox" name="qcApproval" ng-model="quote.qthdr_qcApproval" /></td>
                                                </tr>
                                                                <tr>
                                                    <td style="text-align:right">Approval Request:</td>
                                                    <td><input type="radio" name="requestType" /></td>
                                                </tr>
                                                <tr>
                                                    <td style="text-align:right">Pricing Request:</td>
                                                    <td><input type="radio" name="requestType" /></td>
                                                </tr>
                                                            </table>
                                                        </div>
                                                    </div>*@
                                            <div class="row">
                                                <div class="col-md-12">
                                                    <!--<button class="form-control btn btn-primary">Submit Pack Request</button>-->
                                                    <button class="form-control btn btn-primary" ng-click="save()">Save</button>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-12">
                                                    <br />
                                                    <button class="form-control btn btn-default" ng-click="saveAsTemplate()">Save as Template</button>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-12">
                                                    <br />
                                                    <button class="form-control btn btn-danger" ng-click="remove()">Delete</button>
                                                </div>
                                            </div>

                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <!--
                                <div class="col-md-12">
                                    <button class="form-control btn btn-default">(pdf) Product Quote</button>
                                </div>
                                -->
                            </div>
                            <div class="row">
                                <div class="col-md-12">
                                    <button class="form-control btn btn-default" ng-click="exportCostedExcel()">Costed BOM</button>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12">
                                    <button class="form-control btn btn-default" ng-click="exportCustomerExcel()">Customer BOM</button>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12">
                                    <button class="form-control btn btn-default">Email Quote</button>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>